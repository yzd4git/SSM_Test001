<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/302292 (zh-CN); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="943"/>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>作者：</b></td><td><i>yzd_java@126.com</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><span style="font-size: 19px;">1.创建Maven工程，具体步骤不再阐述</span></div><div><span style="font-size: 19px;">2.修改工程的pom.xml</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt; project xmlns= &quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi= &quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div>    xsi:schemaLocation= &quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;</div><div>       &lt;modelVersion &gt;4.0.0 &lt;/modelVersion &gt;</div><div>       &lt;groupId &gt;2016.06.23 &lt;/groupId &gt;</div><div>       &lt;artifactId &gt;ssm_yzd &lt;/artifactId &gt;</div><div>       &lt;packaging &gt;war &lt;/packaging &gt;</div><div>       &lt;version &gt;0.0.1-SNAPSHOT &lt;/version &gt;</div><div>       &lt;name &gt;ssm_yzd Maven Webapp &lt;/name &gt;</div><div>       &lt;url &gt;http://maven.apache.org &lt;/url &gt;</div><div>       &lt;properties &gt;</div><div>             &lt;!-- spring版本号 --&gt;</div><div>             &lt;spring.version &gt;4.0.2.RELEASE &lt;/spring.version &gt;</div><div>             &lt;!-- mybatis 版本号 --&gt;</div><div>             &lt;mybatis.version &gt;3.2.6 &lt;/mybatis.version &gt;</div><div>             &lt;!-- log4j日志文件管理包版本 --&gt;</div><div>             &lt;slf4j.version &gt;1.7.7 &lt;/slf4j.version &gt;</div><div>             &lt;log4j.version &gt;1.2.17 &lt;/log4j.version &gt;</div><div>       &lt;/properties &gt;</div><div>       &lt;dependencies &gt;</div><div>        &lt;!-- 单元测试 --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt; junit&lt;/ groupId&gt;</div><div>            &lt;artifactId &gt; junit&lt;/ artifactId&gt;</div><div>            &lt;version &gt;4.11 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div><br/></div><div>        &lt;!-- 1.日志 --&gt;</div><div>        &lt;!-- 实现slf4j接口并整合 --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;ch.qos.logback &lt;/groupId &gt;</div><div>            &lt;artifactId &gt; logback-classic&lt;/ artifactId&gt;</div><div>            &lt;version &gt;1.1.1 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div><br/></div><div>        &lt;!-- 2.数据库 --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt; mysql&lt;/ groupId&gt;</div><div>            &lt;artifactId &gt; mysql-connector-java&lt;/ artifactId&gt;</div><div>            &lt;version &gt;5.1.37 &lt;/version &gt;</div><div>            &lt;scope &gt;runtime &lt;/scope &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;c3p0 &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;c3p0 &lt;/artifactId &gt;</div><div>            &lt;version &gt;0.9.1.2 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div><br/></div><div>        &lt;!-- DAO: MyBatis --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.mybatis &lt;/groupId &gt;</div><div>            &lt;artifactId &gt; mybatis&lt;/ artifactId&gt;</div><div>            &lt;version &gt;3.3.0 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.mybatis &lt;/groupId &gt;</div><div>            &lt;artifactId &gt; mybatis-spring&lt;/ artifactId&gt;</div><div>            &lt;version &gt;1.2.3 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div><br/></div><div>        &lt;!-- 3.Servlet web --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt; taglibs&lt;/ groupId&gt;</div><div>            &lt;artifactId &gt;standard &lt;/artifactId &gt;</div><div>            &lt;version &gt;1.1.2 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt; jstl&lt;/ groupId&gt;</div><div>            &lt;artifactId &gt; jstl&lt;/ artifactId&gt;</div><div>            &lt;version &gt;1.2 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;com.fasterxml.jackson.core &lt;/groupId &gt;</div><div>            &lt;artifactId &gt; jackson-databind &lt;/artifactId &gt;</div><div>            &lt;version &gt;2.5.4 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;javax.servlet &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;javax.servlet- api&lt;/ artifactId&gt;</div><div>            &lt;version &gt;3.1.0 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div><br/></div><div>        &lt;!-- 4.Spring --&gt;</div><div>        &lt;!-- 1)Spring核心 --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring-core &lt;/artifactId &gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring-beans &lt;/artifactId &gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring-context &lt;/artifactId &gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;!-- 2)Spring DAO层 --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring- jdbc&lt;/ artifactId&gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring- tx&lt;/ artifactId&gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;!-- 3)Spring web --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring-web &lt;/artifactId &gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring- webmvc&lt;/ artifactId&gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;!-- 4)Spring test --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;org.springframework &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;spring-test &lt;/artifactId &gt;</div><div>            &lt;version &gt;4.1.7.RELEASE &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div><br/></div><div>        &lt;!-- redis客户端: Jedis --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;redis.clients &lt;/groupId &gt;</div><div>            &lt;artifactId &gt; jedis&lt;/ artifactId&gt;</div><div>            &lt;version &gt;2.7.3 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;com.dyuproject.protostuff &lt;/groupId &gt;</div><div>            &lt;artifactId &gt; protostuff-core&lt;/ artifactId&gt;</div><div>            &lt;version &gt;1.0.8 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;com.dyuproject.protostuff &lt;/groupId &gt;</div><div>            &lt;artifactId &gt; protostuff-runtime&lt;/ artifactId&gt;</div><div>            &lt;version &gt;1.0.8 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div><br/></div><div>        &lt;!-- Map工具类 --&gt;</div><div>        &lt;dependency &gt;</div><div>            &lt;groupId &gt;commons-collections &lt;/groupId &gt;</div><div>            &lt;artifactId &gt;commons-collections &lt;/artifactId &gt;</div><div>            &lt;version &gt;3.2 &lt;/version &gt;</div><div>        &lt;/dependency &gt;</div><div>    &lt;/dependencies &gt;</div><div><br/></div><div>&lt; build&gt;</div><div>             &lt;finalName &gt; ssm&lt;/ finalName&gt;</div><div>             &lt;plugins &gt;</div><div>                   &lt;plugin &gt;</div><div>                         &lt;groupId &gt;org.apache.maven.plugins &lt;/groupId &gt;</div><div>                         &lt;artifactId &gt; maven-war-plugin &lt;/artifactId &gt;</div><div>                         &lt;version &gt;2.1-alpha-1 &lt;/version &gt;</div><div>                         &lt;configuration &gt;</div><div>                               &lt;webappDirectory &gt;${basedir}/src/main/webapp &lt;/webappDirectory &gt;</div><div>                               &lt;!-- &lt;warSourceDirectory&gt;${basedir}/ src/main/webapp&lt;/warSourceDirectory&gt; --&gt;</div><div>                         &lt;/configuration &gt;</div><div>                   &lt;/plugin &gt;</div><div>             &lt;/plugins &gt;</div><div>       &lt;/build &gt;</div><div>&lt;/ project&gt;</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">3.在resource中新建spring文件夹，在spring文件夹中新建spring-web.xml</span></div><div><span style="font-size: 19px;">     这个版本是将dao,service,web分开写的</span></div><div style="top: -6276.89px;"><ol><li>读入数据库连接相关参数（可选）</li><li>配置数据连接池<br/><ol><li>配置连接属性，可以不读配置项文件直接在这里写死</li><li>配置c3p0，只配了几个常用的</li></ol></li><li>配置SqlSessionFactory对象（mybatis）</li><li>扫描dao层接口，动态实现dao接口，也就是说不需要daoImpl，sql和参数都写在xml文件上</li></ol><div><br/></div><div>spring-dao.xml</div></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;? xml version= &quot;1.0&quot; encoding= &quot;UTF-8&quot; ?&gt;</div><div>&lt; beans xmlns= &quot;http://www.springframework.org/schema/beans&quot;</div><div>    xmlns:xsi= &quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context =&quot;http://www.springframework.org/schema/context&quot;</div><div>    xsi:schemaLocation= &quot;http://www.springframework.org/schema/beans</div><div>    http://www.springframework.org/schema/beans/spring-beans.xsd</div><div>    http://www.springframework.org/schema/context</div><div>    http://www.springframework.org/schema/context/spring-context.xsd&quot; &gt;</div><div>    &lt;!-- 配置整合mybatis过程 --&gt;</div><div>    &lt;!-- 1.配置数据库相关参数properties的属性：${url} --&gt;</div><div>    &lt;context:property-placeholder location = &quot;classpath:jdbc.properties&quot; /&gt;</div><div><br/></div><div>    &lt;!-- 2.数据库连接池 --&gt;</div><div>    &lt;bean id = &quot;dataSource&quot; class= &quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot; &gt;</div><div>        &lt;!-- 配置连接池属性 --&gt;</div><div>        &lt;property name = &quot;driverClass&quot; value= &quot;${jdbc.driver}&quot; /&gt;</div><div>        &lt;property name = &quot;jdbcUrl&quot; value= &quot;${jdbc.url}&quot; /&gt;</div><div>        &lt;property name = &quot;user&quot; value= &quot;${jdbc.username}&quot; /&gt;</div><div>        &lt;property name = &quot;password&quot; value= &quot;${jdbc.password}&quot; /&gt;</div><div><br/></div><div>        &lt;!-- c3p0连接池的私有属性 --&gt;</div><div>        &lt;property name = &quot;maxPoolSize&quot; value= &quot;30&quot; /&gt;</div><div>        &lt;property name = &quot;minPoolSize&quot; value= &quot;10&quot; /&gt;</div><div>        &lt;!-- 关闭连接后不自动commit --&gt;</div><div>        &lt;property name = &quot;autoCommitOnClose&quot; value= &quot;false&quot; /&gt;</div><div>        &lt;!-- 获取连接超时时间 --&gt;</div><div>        &lt;property name = &quot;checkoutTimeout&quot; value= &quot;10000&quot; /&gt;</div><div>        &lt;!-- 当获取连接失败重试次数 --&gt;</div><div>        &lt;property name = &quot;acquireRetryAttempts&quot; value= &quot;2&quot; /&gt;</div><div>    &lt;/bean &gt;</div><div><br/></div><div>    &lt;!-- 3.配置SqlSessionFactory对象 --&gt;</div><div>    &lt;bean id = &quot;sqlSessionFactory&quot; class= &quot;org.mybatis.spring.SqlSessionFactoryBean&quot; &gt;</div><div>        &lt;!-- 注入数据库连接池 --&gt;</div><div>        &lt;property name = &quot;dataSource&quot; ref= &quot;dataSource&quot; /&gt;</div><div>        &lt;!-- 配置MyBaties全局配置文件:mybatis-config.xml --&gt;</div><div>        &lt;property name = &quot;configLocation&quot; value= &quot;classpath:mybatis-config.xml&quot; /&gt;</div><div>        &lt;!-- 扫描entity包 使用别名 --&gt;</div><div>        &lt;property name = &quot;typeAliasesPackage&quot; value= &quot;com.soecode.yzd.entity&quot; /&gt;</div><div>        &lt;!-- 扫描sql配置文件:mapper需要的xml文件 --&gt;</div><div>        &lt;property name = &quot;mapperLocations&quot; value= &quot;classpath:mapper/*.xml&quot; /&gt;</div><div>    &lt;/bean &gt;</div><div><br/></div><div>    &lt;!-- 4.配置扫描Dao接口包，动态实现Dao接口，注入到spring容器中 --&gt;</div><div>    &lt;bean class = &quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;</div><div>        &lt;!-- 注入sqlSessionFactory --&gt;</div><div>        &lt;property name = &quot;sqlSessionFactoryBeanName&quot; value= &quot;sqlSessionFactory&quot; /&gt;</div><div>        &lt;!-- 给出需要扫描Dao接口包 --&gt;</div><div>        &lt;property name = &quot;basePackage&quot; value= &quot;com.soecode.yzd.dao&quot; /&gt;</div><div>    &lt;/bean &gt;</div><div>&lt;/ beans&gt;</div></div><div>顺道把包给建上com.soecode.yzd.dao 和 com.soecode.yzd.entity</div><div><span style="font-size: 19px;">4.紧跟着我们就新建jdbc.properties</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>jdbc.driver= com.mysql.jdbc.Driver</div><div>jdbc.url= jdbc:mysql://127.0.0.1:3306/ssm?useUnicode=true&amp;amp;characterEncoding=UTF8</div><div>jdbc.username= </div><div>jdbc.password= </div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">5.然后新建mybatis-config.xml</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;? xml version= &quot;1.0&quot; encoding= &quot;UTF-8&quot; ?&gt;</div><div>&lt;! DOCTYPE configuration</div><div>  PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</div><div>  &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot; &gt;</div><div>&lt; configuration&gt;</div><div>    &lt;!-- 配置全局属性 --&gt;</div><div>    &lt;settings &gt;</div><div>        &lt;!-- 使用jdbc的getGeneratedKeys获取数据库自增主键值 --&gt;</div><div>        &lt;setting name = &quot;useGeneratedKeys&quot; value= &quot;true&quot; /&gt;</div><div><br/></div><div>        &lt;!-- 使用列别名替换列名 默认:true --&gt;</div><div>        &lt;setting name = &quot;useColumnLabel&quot; value= &quot;true&quot; /&gt;</div><div><br/></div><div>        &lt;!-- 开启驼峰命名转换:Table{create_time} -&gt; Entity{createTime} --&gt;</div><div>        &lt;setting name = &quot;mapUnderscoreToCamelCase&quot; value= &quot;true&quot; /&gt;</div><div>    &lt;/settings &gt;</div><div>&lt;/ configuration&gt;</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">6.在resource的spring文件夹中新建spring-service.xml</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;? xml version= &quot;1.0&quot; encoding= &quot;UTF-8&quot; ?&gt;</div><div>&lt; beans xmlns= &quot;http://www.springframework.org/schema/beans&quot;</div><div>    xmlns:xsi= &quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br/><br/></div><div><br/></div><div>    xmlns:context= &quot;http://www.springframework.org/schema/context&quot;</div><div>    xmlns:tx= &quot;http://www.springframework.org/schema/tx&quot;</div><div>    xsi:schemaLocation= &quot;http://www.springframework.org/schema/beans</div><div>    http://www.springframework.org/schema/beans/spring-beans.xsd</div><div>    http://www.springframework.org/schema/context</div><div>    http://www.springframework.org/schema/context/spring-context.xsd</div><div>    http://www.springframework.org/schema/tx</div><div>    http://www.springframework.org/schema/tx/spring-tx.xsd&quot; &gt;</div><div>    &lt;!-- 扫描service包下所有使用注解的类型 --&gt;</div><div>    &lt;context:component-scan base-package = &quot;com.soecode.yzd.service&quot; /&gt;</div><div><br/></div><div>    &lt;!-- 配置事务管理器 --&gt;</div><div>    &lt;bean id = &quot;transactionManager&quot;</div><div>        class= &quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot; &gt;</div><div>        &lt;!-- 注入数据库连接池 --&gt;</div><div>        &lt;property name = &quot;dataSource&quot; ref= &quot;dataSource&quot; /&gt;</div><div>    &lt;/bean &gt;</div><div><br/></div><div>    &lt;!-- 配置基于注解的声明式事务 --&gt;</div><div>    &lt;tx:annotation-driven transaction-manager = &quot;transactionManager&quot; /&gt;</div><div>&lt;/ beans&gt;</div></div><div>顺道把包给建上com.soecode.yzd.service</div><div><br/></div><div><span style="font-size: 19px;">7.继续新建 spring-web.xml</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;? xml version= &quot;1.0&quot; encoding= &quot;UTF-8&quot; ?&gt;</div><div>&lt; beans xmlns= &quot;http://www.springframework.org/schema/beans&quot;</div><div>    xmlns:xsi= &quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div>    xmlns:context= &quot;http://www.springframework.org/schema/context&quot;</div><div>    xmlns:mvc= &quot;http://www.springframework.org/schema/mvc&quot;<br/><br/></div><div><br/></div><div>    xsi:schemaLocation= &quot;http://www.springframework.org/schema/beans</div><div>    http://www.springframework.org/schema/beans/spring-beans.xsd</div><div>    http://www.springframework.org/schema/context</div><div>    http://www.springframework.org/schema/context/spring-context.xsd</div><div>    http://www.springframework.org/schema/mvc</div><div>    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd&quot; &gt;</div><div>    &lt;!-- 配置SpringMVC --&gt;</div><div>    &lt;!-- 1.开启SpringMVC注解模式 --&gt;</div><div>    &lt;!-- 简化配置：</div><div>        (1)自动注册DefaultAnootationHandlerMapping,AnotationMethodHandlerAdapter</div><div>        (2)提供一些列：数据绑定，数字和日期的format @NumberFormat, @DateTimeFormat, xml, json默认读写支持</div><div>    --&gt;</div><div>    &lt;mvc:annotation-driven /&gt;</div><div><br/></div><div>    &lt;!-- 2.静态资源默认servlet 配置</div><div>        (1)加入对静态资源的处理： js,gif ,png</div><div>        (2)允许使用&quot;/&quot;做整体映射</div><div>     --&gt;</div><div>     &lt;mvc:default-servlet-handler /&gt;</div><div><br/></div><div>     &lt;!-- 3.配置jsp 显示ViewResolver --&gt;</div><div>     &lt;bean class= &quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot; &gt;</div><div>        &lt;property name = &quot;viewClass&quot; value= &quot;org.springframework.web.servlet.view.JstlView&quot; /&gt;</div><div>        &lt;property name = &quot;prefix&quot; value= &quot;/WEB-INF/jsp/&quot; /&gt;</div><div>        &lt;property name = &quot;suffix&quot; value= &quot;.jsp&quot; /&gt;</div><div>     &lt;/bean &gt;</div><div><br/></div><div>     &lt;!-- 4.扫描web相关的bean --&gt;</div><div>     &lt;context:component-scan base-package = &quot;com.soecode.yzd.web&quot; /&gt;</div><div>&lt;/ beans&gt;</div></div><div>顺道把包给建上com.soecode.yzd.web</div><div><span style="font-size: 19px;">8.修改web.xml</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt; web-app xmlns= &quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi= &quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div>    xsi:schemaLocation= &quot;http://xmlns.jcp.org/xml/ns/javaee</div><div>                      http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</div><div>    version= &quot;3.1&quot; metadata-complete= &quot;true&quot; &gt;</div><div>    &lt;!-- 如果是用mvn命令生成的 xml，需要修改 servlet版本为3.1 --&gt;</div><div>    &lt;!-- 配置DispatcherServlet --&gt;</div><div>    &lt;servlet &gt;</div><div>        &lt;servlet-name &gt; seckill-dispatcher&lt;/ servlet-name &gt;</div><div>        &lt; servlet-class&gt; org.springframework.web.servlet.DispatcherServlet &lt;/servlet-class &gt;</div><div>        &lt;!-- 配置springMVC需要加载的配置文件</div><div>            spring-dao.xml,spring-service.xml,spring-web.xml</div><div>            Mybatis - &gt; spring -&gt; springmvc</div><div>         --&gt;</div><div>        &lt;init-param &gt;</div><div>            &lt;param-name &gt;contextConfigLocation &lt;/param-name &gt;</div><div>            &lt;param-value &gt;classpath:spring/spring-*. xml&lt;/ param-value &gt;</div><div>        &lt;/init-param &gt;</div><div>    &lt;/servlet &gt;</div><div>    &lt;servlet-mapping &gt;</div><div>        &lt;servlet-name &gt; seckill-dispatcher&lt;/ servlet-name &gt;</div><div>        &lt;!-- 默认匹配所有的请求 --&gt;</div><div>        &lt;url-pattern &gt;/ &lt;/url-pattern &gt;</div><div>    &lt;/servlet-mapping &gt;</div><div>&lt;/ web-app&gt;</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">9.项目中肯定会用到日志，我们这边采用的是logbcak.新建</span><span style="font-size: 19px;">logbcak.properties</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;configuration debug=&quot;true&quot;&gt;<br/>
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;<br/>
        &lt;!-- encoders are by default assigned the type ch.qos.logback.classic.encoder.PatternLayoutEncoder --&gt;<br/>
        &lt;encoder&gt;<br/>
            &lt;pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;<br/>
        &lt;/encoder&gt;<br/>
    &lt;/appender&gt;<br/><br/>
    &lt;root level=&quot;debug&quot;&gt;<br/>
        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;<br/>
    &lt;/root&gt;&lt;/configuration&gt;</div></div><div><br/></div><div><span style="font-size: 19px;">到目前为止，一共涉及到7个配置文件</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><img src="步骤_files/Image.png" type="image/png" style="height: auto;"/></div></div><div><br/></div><div><br/></div><div><span style="font-size: 19px;">框架已经搭建完毕，下面进行一个实例。以查询图书和预约图书为例。</span></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">1.首先新建数据库，然后创建表</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>-- 创建图书表CREATE TABLE `book` (<br/>
  `book_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '图书ID',<br/>
  `name` varchar(100) NOT NULL COMMENT '图书名称',<br/>
  `number` int(11) NOT NULL COMMENT '馆藏数量',<br/>
  PRIMARY KEY (`book_id`)<br/>
) ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=utf8 COMMENT='图书表'<br/><br/>
-- 初始化图书数据<br/>
INSERT INTO `book` (`book_id`, `name`, `number`)<br/>
VALUES<br/>
    (1000, 'Java程序设计', 10),<br/>
    (1001, '数据结构', 10),<br/>
    (1002, '设计模式', 10),<br/>
    (1003, '编译原理', 10)<br/><br/>
-- 创建预约图书表<br/>
CREATE TABLE `appointment` (<br/>
  `book_id` bigint(20) NOT NULL COMMENT '图书ID',<br/>
  `student_id` bigint(20) NOT NULL COMMENT '学号',<br/>
  `appoint_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '预约时间' ,<br/>
  PRIMARY KEY (`book_id`, `student_id`),<br/>
  INDEX `idx_appoint_time` (`appoint_time`)<br/>
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='预约图书表'</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">2.可以使用逆向工程生成实体类，Dao，和mapper文件</span></div><div><span style="font-size: 19px;">这边提供了内容，方便使用</span></div><div><span style="font-size: 19px;">book.java</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.entity;</div><div><br/></div><div>public class Book {</div><div><br/></div><div>       private long bookId; // 图书ID</div><div><br/></div><div>       private String name; // 图书名称</div><div><br/></div><div>       private int number; // 馆藏数量</div><div><br/></div><div>       public long getBookId() {</div><div>             return bookId;</div><div>      }</div><div><br/></div><div>       public void setBookId( long bookId) {</div><div>             this. bookId = bookId;</div><div>      }</div><div><br/></div><div>       public String getName() {</div><div>             return name;</div><div>      }</div><div><br/></div><div>       public void setName(String name) {</div><div>             this. name = name;</div><div>      }</div><div><br/></div><div>       public int getNumber() {</div><div>             return number;</div><div>      }</div><div><br/></div><div>       public void setNumber( int number) {</div><div>             this. number = number;</div><div>      }</div><div><br/></div><div>       public Book( long bookId, String name, int number) {</div><div>             super();</div><div>             this. bookId = bookId;</div><div>             this. name = name;</div><div>             this. number = number;</div><div>      }</div><div><br/></div><div>       public Book() {</div><div>             // TODO Auto-generated constructor stub</div><div>      }</div><div><br/></div><div>       @Override</div><div>       public String toString() {</div><div>             return &quot;Book [bookId=&quot; + bookId + &quot;, name=&quot; + name + &quot;, number=&quot; + number + &quot;]&quot;;</div><div>      }</div><div>}</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">Appointment.java</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.entity;</div><div><br/></div><div>import java.util.Date;</div><div><br/></div><div>public class Appointment {</div><div><br/></div><div>       private long bookId; // 图书ID</div><div><br/></div><div>       private long studentId; // 学号</div><div><br/></div><div>       private Date appointTime; // 预约时间</div><div><br/></div><div>       // 多对一的复合属性</div><div>       private Book book; // 图书实体</div><div><br/></div><div>       public long getBookId() {</div><div>             return bookId;</div><div>      }</div><div><br/></div><div>       public void setBookId( long bookId) {</div><div>             this. bookId = bookId;</div><div>      }</div><div><br/></div><div>       public long getStudentId() {</div><div>             return studentId;</div><div>      }</div><div><br/></div><div>       public void setStudentId( long studentId) {</div><div>             this. studentId = studentId;</div><div>      }</div><div><br/></div><div>       public Date getAppointTime() {</div><div>             return appointTime;</div><div>      }</div><div><br/></div><div>       public void setAppointTime(Date appointTime) {</div><div>             this. appointTime = appointTime;</div><div>      }</div><div><br/></div><div>       public Book getBook() {</div><div>             return book;</div><div>      }</div><div><br/></div><div>       public void setBook(Book book) {</div><div>             this. book = book;</div><div>      }</div><div><br/></div><div>       public Appointment( long bookId, long studentId, Date appointTime, Book book) {</div><div>             super();</div><div>             this. bookId = bookId;</div><div>             this. studentId = studentId;</div><div>             this. appointTime = appointTime;</div><div>             this. book = book;</div><div>      }</div><div><br/></div><div>       public Appointment() {</div><div>             // TODO Auto-generated constructor stub</div><div>      }</div><div><br/></div><div>       @Override</div><div>       public String toString() {</div><div>             return &quot;Appointment [bookId=&quot; + bookId + &quot;, studentId=&quot; + studentId + &quot;, appointTime=&quot; + appointTime + &quot;, book=&quot;</div><div>                        + book + &quot;]&quot;;</div><div>      }</div><div><br/></div><div>}</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">接下来就是Dao层</span></div><div><span style="font-size: 19px;">BookDao</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.dao;</div><div><br/></div><div>import java.util.List;</div><div><br/></div><div>import org.apache.ibatis.annotations.Param;</div><div><br/></div><div>import com.soecode.yzd.entity.Book;</div><div><br/></div><div>public interface BookDao {</div><div><br/></div><div>    /**</div><div>     * 通过ID查询单本图书</div><div>     *</div><div>     * @param id</div><div>     * @return</div><div>     */</div><div>    Book queryById(long id);</div><div><br/></div><div>    /**</div><div>     * 查询所有图书</div><div>     *</div><div>     * @param offset</div><div>     *            查询起始位置</div><div>     * @param limit</div><div>     *            查询条数</div><div>     * @return</div><div>     */</div><div>    List&lt;Book&gt; queryAll(@Param(&quot;offset&quot;) int offset, @Param(&quot;limit&quot;) int limit);</div><div><br/></div><div>    /**</div><div>     * 减少馆藏数量</div><div>     *</div><div>     * @param bookId</div><div>     * @return 如果影响行数等于&gt;1，表示更新的记录行数</div><div>     */</div><div>    int reduceNumber(long bookId);</div><div><br/></div><div>}</div><div><br/></div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">AppointmentDao</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.dao;</div><div><br/></div><div>import org.apache.ibatis.annotations.Param;</div><div><br/></div><div>import com.soecode.yzd.entity.Appointment;</div><div><br/></div><div>public interface AppointmentDao {</div><div><br/></div><div>    /**</div><div>     * 插入预约图书记录</div><div>     *</div><div>     * @param bookId</div><div>     * @param studentId</div><div>     * @return 插入的行数</div><div>     */</div><div>    int insertAppointment(@Param(&quot;bookId&quot;) long bookId, @Param(&quot;studentId&quot;) long studentId);</div><div><br/></div><div>    /**</div><div>     * 通过主键查询预约图书记录，并且携带图书实体</div><div>     *</div><div>     * @param bookId</div><div>     * @param studentId</div><div>     * @return</div><div>     */</div><div>    Appointment queryByKeyWithBook(@Param(&quot;bookId&quot;) long bookId, @Param(&quot;studentId&quot;) long studentId);</div><div><br/></div><div>}</div><div><br/></div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">这边的mapper文件放在了resource文件中，相关文件如下</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;? xml version= &quot;1.0&quot; encoding= &quot;UTF-8&quot; ?&gt;</div><div>&lt;! DOCTYPE mapper</div><div>    PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</div><div>    &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</div><div>&lt; mapper namespace= &quot;com.soecode.yzd.dao.BookDao&quot; &gt;</div><div>    &lt;!-- 目的：为dao接口方法提供sql语句配置 --&gt;</div><div>    &lt;select id = &quot;queryById&quot; resultType= &quot;Book&quot; parameterType= &quot;long&quot; &gt;</div><div>        &lt;!-- 具体的sql --&gt;</div><div>        SELECT</div><div>            book_id,</div><div>            name,</div><div>            number</div><div>        FROM</div><div>            book</div><div>        WHERE</div><div>            book_id = #{bookId}</div><div>    &lt;/select &gt;</div><div><br/></div><div>    &lt;select id = &quot;queryAll&quot; resultType= &quot;Book&quot;&gt;</div><div>        SELECT</div><div>            book_id,</div><div>            name,</div><div>            number</div><div>        FROM</div><div>            book</div><div>        ORDER BY</div><div>            book_id</div><div>        LIMIT #{offset}, #{limit}</div><div>    &lt;/select &gt;</div><div><br/></div><div>    &lt;update id = &quot;reduceNumber&quot;&gt;</div><div>        UPDATE book</div><div>        SET number = number - 1</div><div>        WHERE</div><div>            book_id = #{bookId}</div><div>        AND number &gt; 0</div><div>    &lt;/update &gt;</div><div>&lt;/ mapper&gt;</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">AppointmentDao.xml</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;? xml version= &quot;1.0&quot; encoding= &quot;UTF-8&quot; ?&gt;</div><div>&lt;! DOCTYPE mapper</div><div>    PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</div><div>    &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</div><div>&lt; mapper namespace= &quot;com.soecode.yzd.dao.AppointmentDao&quot; &gt;</div><div>    &lt;insert id = &quot;insertAppointment&quot;&gt;</div><div>        &lt;!-- ignore 主键冲突，报错 --&gt;</div><div>        INSERT ignore INTO appointment (book_id, student_id)</div><div>        VALUES (#{bookId}, #{studentId})</div><div>    &lt;/insert &gt;</div><div><br/></div><div>    &lt;select id = &quot;queryByKeyWithBook&quot; resultType= &quot;Appointment&quot; &gt;</div><div>        &lt;!-- 如何告诉MyBatis把结果映射到Appointment同时映射book属性 --&gt;</div><div>        &lt;!-- 可以自由控制SQL --&gt;</div><div>        SELECT</div><div>            a.book_id,</div><div>            a.student_id,</div><div>            a.appoint_time,</div><div>            b.book_id &quot;book.book_id&quot;,</div><div>            b.`name` &quot;book.name&quot;,</div><div>            b.number &quot;book.number&quot;</div><div>        FROM</div><div>            appointment a</div><div>        INNER JOIN book b ON a.book_id = b.book_id</div><div>        WHERE</div><div>            a.book_id = #{bookId}</div><div>        AND a.student_id = #{studentId}</div><div>    &lt;/select &gt;</div><div>&lt;/ mapper&gt;</div></div><div><strong>mapper总结</strong>：<code>namespace</code>是该xml对应的接口全名，<code>select</code>和<code>update</code>中的<code>id</code>对应方法名，<code>resultType</code>是返回值类型，<code>parameterType</code>是参数类型（这个其实可选），最后<code>#{...}</code>中填写的是方法的参数，看懂了是不是很简单！！我也这么觉得~ 还有一个小技巧要交给大家，就是在返回<code>Appointment</code>对象包含了一个属性名为<code>book</code>的Book对象，那么可以使用<code>&quot;book.属性名&quot;</code>的方式来取值，看上面<code>queryByKeyWithBook</code>方法的sql。</div><div><br/></div><div><span style="font-size: 19px;">下面我们就开始进行一下测试。</span></div><div>          因为我们之后会写很多测试方法，在测试前需要让程序读入spring-dao和mybatis等配置文件，所以我这里就抽离出来一个<code>BaseTest</code>类，只要是测试方法就继承它，这样那些繁琐的重复的代码就不用写那么多了~</div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd;</div><div><br/></div><div>import org.junit.runner.RunWith;</div><div>import org.springframework.test.context.ContextConfiguration;</div><div>import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</div><div><br/></div><div>/**</div><div> * 配置spring和junit整合，junit启动时加载springIOC容器 spring-test,junit</div><div> */</div><div>@RunWith(SpringJUnit4ClassRunner.class)</div><div>// 告诉junit spring配置文件</div><div>@ContextConfiguration({ &quot;classpath:spring/spring-dao.xml&quot;, &quot;classpath:spring/spring-service.xml&quot; })</div><div>public class BaseTest {</div><div><br/></div><div>}</div></div><div>          因为<code>spring-service</code>在<code>service</code>层的测试中会时候到，这里也一起引入算了！</div><div style="top: -17139px;"><div style="margin-left:40px;"><br/></div><div style="margin-left:40px;">新建<code>BookDaoTest.java</code>和<code>AppointmentDaoTest.java</code>两个dao测试文件。</div><div style="margin-left:40px;"><br/></div><div style="margin-left:40px;">BookDaoTest.java</div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.dao;</div><div><br/></div><div>import java.util.List;</div><div><br/></div><div>import org.junit.Test;</div><div>import org.springframework.beans.factory.annotation.Autowired;</div><div><br/></div><div>import com.soecode.yzd.BaseTest;</div><div>import com.soecode.yzd.entity.Book;</div><div><br/></div><div>public class BookDaoTest extends BaseTest {</div><div><br/></div><div>    @Autowired</div><div>    private BookDao bookDao;</div><div><br/></div><div>    @Test</div><div>    public void testQueryById() throws Exception {</div><div>        long bookId = 1000;</div><div>        Book book = bookDao.queryById(bookId);</div><div>        System.out.println(book);</div><div>    }</div><div><br/></div><div>    @Test</div><div>    public void testQueryAll() throws Exception {</div><div>        List&lt;Book&gt; books = bookDao.queryAll(0, 4);</div><div>        for (Book book : books) {</div><div>            System.out.println(book);</div><div>        }</div><div>    }</div><div><br/></div><div>    @Test</div><div>    public void testReduceNumber() throws Exception {</div><div>        long bookId = 1000;</div><div>        int update = bookDao.reduceNumber(bookId);</div><div>        System.out.println(&quot;update=&quot; + update);</div><div>    }</div><div><br/></div><div>}</div><div><br/></div></div><div style="margin-left:40px;"><br/></div></div><div><span style="font-size: 19px;">AppointmentDaoTest.java</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.dao;</div><div><br/></div><div>import org.junit.Test;</div><div>import org.springframework.beans.factory.annotation.Autowired;</div><div><br/></div><div>import com.soecode.yzd.BaseTest;</div><div>import com.soecode.yzd.entity.Appointment;</div><div><br/></div><div>public class AppointmentDaoTest extends BaseTest {</div><div><br/></div><div>    @Autowired</div><div>    private AppointmentDao appointmentDao;</div><div><br/></div><div>    @Test</div><div>    public void testInsertAppointment() throws Exception {</div><div>        long bookId = 1000;</div><div>        long studentId = 12345678910L;</div><div>        int insert = appointmentDao.insertAppointment(bookId, studentId);</div><div>        System.out.println(&quot;insert=&quot; + insert);</div><div>    }</div><div><br/></div><div>    @Test</div><div>    public void testQueryByKeyWithBook() throws Exception {</div><div>        long bookId = 1000;</div><div>        long studentId = 12345678910L;</div><div>        Appointment appointment = appointmentDao.queryByKeyWithBook(bookId, studentId);</div><div>        System.out.println(appointment);</div><div>        System.out.println(appointment.getBook());</div><div>    }</div><div><br/></div><div>}</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">执行相应的test。查看结果，以上测试的内容图如下</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><img src="步骤_files/Image [1].png" type="image/png" style="height: auto;"/></div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">接下来就开始写业务了，这边用到了枚举。</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><img src="步骤_files/Image [2].png" type="image/png" style="height: auto;"/></div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">新建一个包叫<code>enums</code>，在里面新建一个枚举类<code>AppointStateEnum.java</code></span></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.148438);"><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">package com.soecode.yzd.enums;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">/**</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"> * 使用枚举表述常量数据字典</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"> */</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">public enum AppointStateEnum {</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">       SUCCESS(1, &quot;预约成功&quot; ), NO_NUMBER (0, &quot;库存不足&quot; ), REPEAT_APPOINT (-1, &quot;重复预约&quot; ), INNER_ERROR(-2, &quot;系统异常&quot;);</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">       private int state;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">       private String stateInfo;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">       private AppointStateEnum( int state, String stateInfo) {</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">             this. state = state;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">             this. stateInfo = stateInfo;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">      }</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">       public int getState() {</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">             return state;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">      }</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">       public String getStateInfo() {</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">             return stateInfo;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">      }</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">       public static AppointStateEnum stateOf( int index) {</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">             for (AppointStateEnum state : values()) {</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">                   if ( state.getState() == index) {</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">                         return state;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">                  }</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">            }</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">             return null;</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">      }</span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);"><br/></span></span></div><div><span style="font-family: Monaco, Menlo, Consolas, &apos;Courier New&apos;, monospace;"><span style="color: rgb(51, 51, 51);">}</span></span></div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">在dto文件夹中AppointExecution.java 。用来存储我们执行预约操作返回的结果</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.dto;</div><div><br/></div><div>import com.soecode.yzd.entity.Appointment;</div><div>import com.soecode.yzd.enums.AppointStateEnum;</div><div><br/></div><div>public class AppointExecution {</div><div><br/></div><div>    // 图书ID</div><div>    private long bookId;</div><div><br/></div><div>    // 秒杀预约结果状态</div><div>    private int state;</div><div><br/></div><div>    // 状态标识</div><div>    private String stateInfo;</div><div><br/></div><div>    // 预约成功对象</div><div>    private Appointment appointment;</div><div><br/></div><div>    public AppointExecution() {</div><div>    }</div><div><br/></div><div>    // 预约失败的构造器</div><div>    public AppointExecution(long bookId, AppointStateEnum stateEnum) {</div><div>        this.bookId = bookId;</div><div>        this.state = stateEnum.getState();</div><div>        this.stateInfo = stateEnum.getStateInfo();</div><div>    }</div><div><br/></div><div>    // 预约成功的构造器</div><div>    public AppointExecution(long bookId, AppointStateEnum stateEnum, Appointment appointment) {</div><div>        this.bookId = bookId;</div><div>        this.state = stateEnum.getState();</div><div>        this.stateInfo = stateEnum.getStateInfo();</div><div>        this.appointment = appointment;</div><div>    }</div><div><br/></div><div>    public long getBookId() {</div><div>        return bookId;</div><div>    }</div><div><br/></div><div>    public void setBookId(long bookId) {</div><div>        this.bookId = bookId;</div><div>    }</div><div><br/></div><div>    public int getState() {</div><div>        return state;</div><div>    }</div><div><br/></div><div>    public void setState(int state) {</div><div>        this.state = state;</div><div>    }</div><div><br/></div><div>    public String getStateInfo() {</div><div>        return stateInfo;</div><div>    }</div><div><br/></div><div>    public void setStateInfo(String stateInfo) {</div><div>        this.stateInfo = stateInfo;</div><div>    }</div><div><br/></div><div>    public Appointment getAppointment() {</div><div>        return appointment;</div><div>    }</div><div><br/></div><div>    public void setAppointment(Appointment appointment) {</div><div>        this.appointment = appointment;</div><div>    }</div><div><br/></div><div><br/></div><div>    @Override</div><div>    public String toString() {</div><div>        return &quot;AppointExecution [bookId=&quot; + bookId + &quot;, state=&quot; + state + &quot;, stateInfo=&quot; + stateInfo + &quot;, appointment=&quot;</div><div>                + appointment + &quot;]&quot;;</div><div>    }</div><div><br/></div><div>}</div><div><br/></div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">在service包下新建BookService.java</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.service;</div><div><br/></div><div>import java.util.List;</div><div><br/></div><div>import com.soecode.yzd.dto.AppointExecution;</div><div>import com.soecode.yzd.entity.Book;</div><div><br/></div><div>/**</div><div> * 业务接口：站在&quot;使用者&quot;角度设计接口 三个方面：方法定义粒度，参数，返回类型（return 类型/异常）</div><div> */</div><div>public interface BookService {</div><div><br/></div><div>    /**</div><div>     * 查询一本图书</div><div>     *</div><div>     * @param bookId</div><div>     * @return</div><div>     */</div><div>    Book getById(long bookId);</div><div><br/></div><div>    /**</div><div>     * 查询所有图书</div><div>     *</div><div>     * @return</div><div>     */</div><div>    List&lt;Book&gt; getList();</div><div><br/></div><div>    /**</div><div>     * 预约图书</div><div>     *</div><div>     * @param bookId</div><div>     * @param studentId</div><div>     * @return</div><div>     */</div><div>    AppointExecution appoint(long bookId, long studentId);</div><div><br/></div><div>}</div></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">创建service的实现类</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.service.impl;</div><div><br/></div><div>import java.util.List;</div><div><br/></div><div>import org.slf4j.Logger;</div><div>import org.slf4j.LoggerFactory;</div><div>import org.springframework.beans.factory.annotation.Autowired;</div><div>import org.springframework.stereotype.Service;</div><div>import org.springframework.transaction.annotation.Transactional;</div><div><br/></div><div>import com.soecode.yzd.dao.AppointmentDao;</div><div>import com.soecode.yzd.dao.BookDao;</div><div>import com.soecode.yzd.dto.AppointExecution;</div><div>import com.soecode.yzd.entity.Appointment;</div><div>import com.soecode.yzd.entity.Book;</div><div>import com.soecode.yzd.enums.AppointStateEnum;</div><div>import com.soecode.yzd.service.BookService;</div><div><br/></div><div>@Service</div><div>public class BookServiceImpl implements BookService {</div><div><br/></div><div>    private Logger logger = LoggerFactory.getLogger(this.getClass());</div><div><br/></div><div>    // 注入Service依赖</div><div>    @Autowired</div><div>    private BookDao bookDao;</div><div><br/></div><div>    @Autowired</div><div>    private AppointmentDao appointmentDao;</div><div><br/></div><div>    @Override</div><div>    public Book getById(long bookId) {</div><div>        return bookDao.queryById(bookId);</div><div>    }</div><div><br/></div><div>    @Override</div><div>    public List&lt;Book&gt; getList() {</div><div>        return bookDao.queryAll(0, 1000);</div><div>    }</div><div><br/></div><div><br/></div><div><br/></div><div>    @Override</div><div>    @Transactional</div><div>    /**</div><div>     * 使用注解控制事务方法的优点： 1.开发团队达成一致约定，明确标注事务方法的编程风格</div><div>     * 2.保证事务方法的执行时间尽可能短，不要穿插其他网络操作，RPC/HTTP请求或者剥离到事务方法外部</div><div>     * 3.不是所有的方法都需要事务，如只有一条修改操作，只读操作不需要事务控制</div><div>     */</div><div>    public AppointExecution appoint(long bookId, long studentId) {</div><div>        try {</div><div>            // 减库存</div><div>            int update = bookDao.reduceNumber(bookId);</div><div>            if (update &lt;= 0) {// 库存不足</div><div>                return new AppointExecution(bookId, AppointStateEnum.NO_NUMBER);</div><div>            } else {</div><div>                // 执行预约操作</div><div>                int insert = appointmentDao.insertAppointment(bookId, studentId);</div><div>                if (insert &lt;= 0) {// 重复预约</div><div>                    return new AppointExecution(bookId, AppointStateEnum.REPEAT_APPOINT);</div><div>                } else {// 预约成功</div><div>                    Appointment appointment = appointmentDao.queryByKeyWithBook(bookId, studentId);</div><div>                    return new AppointExecution(bookId, AppointStateEnum.SUCCESS, appointment);</div><div>                }</div><div>            }</div><div>        } catch (Exception e) {</div><div>            logger.error(e.getMessage(), e);</div><div>            // 所有编译期异常转换为运行期异常</div><div>            return new AppointExecution(bookId, AppointStateEnum.INNER_ERROR);</div><div>        }</div><div>    }</div><div><br/></div><div>}</div><div><br/></div></div><div style="top: -25265.25px;"><div style="margin-left:40px;"><br/></div><div style="margin-left:40px;">下面我们来测试一下我们的业务代码吧~因为查询图书的业务不复杂，所以这里只演示我们最重要的预约图书业务！！</div></div><div><span style="font-size: 19px;"><br/></span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.service.impl;<br/><br/>
import static org.junit.Assert.fail;<br/><br/>
import org.junit.Test;<br/>
import org.springframework.beans.factory.annotation.Autowired;<br/><br/></div><div>import com.soecode.yzd.BaseTest;</div><div>import com.soecode.yzd.dto.AppointExecution;</div><div>import com.soecode.yzd.service.BookService;</div><div><br/>
public class BookServiceImplTest extends BaseTest {<br/><br/>
    @Autowired<br/>
    private BookService bookService;<br/><br/>
    @Test<br/>
    public void testAppoint() throws Exception {<br/>
        long bookId = 1001;<br/>
        long studentId = 12345678910L;<br/>
        AppointExecution execution = bookService.appoint(bookId, studentId);<br/>
        System.out.println(execution);<br/>
    }<br/><br/>
}</div></div><div><span style="font-size: 19px;"><br/></span></div><div>首次执行的时候会显示  预约成功， 第二次运行的时候将会显示 重复预约。这样的话就证明我们的程序是没有错的</div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;">咱们还需要在<code>dto</code>包里新建一个封装json返回结果的类<code>Result.java</code>，设计成泛型。</span></div><div><span style="font-size: 19px;">Result.java</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.dto;</div><div><br/></div><div>/**</div><div> * 封装 json对象，所有返回结果都使用它</div><div> */</div><div>public class Result&lt;T&gt; {</div><div><br/></div><div>       private boolean success; // 是否成功标志</div><div><br/></div><div>       private T data; // 成功时返回的数据</div><div><br/></div><div>       private String error; // 错误信息</div><div><br/></div><div>       public Result() {</div><div>      }</div><div><br/></div><div>       // 成功时的构造器</div><div>       public Result( boolean success, T data) {</div><div>             this. success = success;</div><div>             this. data = data;</div><div>      }</div><div><br/></div><div>       // 错误时的构造器</div><div>       public Result( boolean success, String error) {</div><div>             this. success = success;</div><div>             this. error = error;</div><div>      }</div><div><br/></div><div>       public boolean isSuccess() {</div><div>             return success;</div><div>      }</div><div><br/></div><div>       public void setSuccess( boolean success) {</div><div>             this. success = success;</div><div>      }</div><div><br/></div><div>       public T getData() {</div><div>             return data;</div><div>      }</div><div><br/></div><div>       public void setData(T data) {</div><div>             this. data = data;</div><div>      }</div><div><br/></div><div>       public String getError() {</div><div>             return error;</div><div>      }</div><div><br/></div><div>       public void setError(String error) {</div><div>             this. error = error;</div><div>      }</div><div><br/></div><div>       public Result( boolean success, T data, String error) {</div><div>             super();</div><div>             this. success = success;</div><div>             this. data = data;</div><div>             this. error = error;</div><div>      }</div><div><br/></div><div>       @Override</div><div>       protected Object clone() throws CloneNotSupportedException {</div><div>             // TODO Auto-generated method stub</div><div>             return super.clone();</div><div>      }</div><div><br/></div><div>       @Override</div><div>       public String toString() {</div><div>             return &quot;Result [success=&quot; + success + &quot;, data=&quot; + data + &quot;, error=&quot; + error + &quot;]&quot;;</div><div>      }</div><div><br/></div><div>}</div></div><div><br/></div><div><span style="font-size: 19px;">最后，我们写web层。也就是controller。新建BookController.java</span></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.soecode.yzd.web;</div><div><br/></div><div>import java.util.List;</div><div><br/></div><div>import org.apache.ibatis.annotations.Param;</div><div>import org.slf4j.Logger;</div><div>import org.slf4j.LoggerFactory;</div><div>import org.springframework.beans.factory.annotation.Autowired;</div><div>import org.springframework.stereotype.Controller;</div><div>import org.springframework.ui.Model;</div><div>import org.springframework.web.bind.annotation.PathVariable;</div><div>import org.springframework.web.bind.annotation.RequestMapping;</div><div>import org.springframework.web.bind.annotation.RequestMethod;</div><div>import org.springframework.web.bind.annotation.ResponseBody;</div><div><br/></div><div>import com.soecode.yzd.dto.AppointExecution;</div><div>import com.soecode.yzd.dto.Result;</div><div>import com.soecode.yzd.entity.Book;</div><div>import com.soecode.yzd.service.BookService;</div><div><br/></div><div>@Controller</div><div>@RequestMapping(&quot;/book&quot;) // url:/模块/资源/{id}/细分 /seckill/list</div><div>public class BookController {</div><div><br/></div><div>    private Logger logger = LoggerFactory.getLogger(this.getClass());</div><div><br/></div><div>    @Autowired</div><div>    private BookService bookService;</div><div><br/></div><div>    @RequestMapping(value = &quot;/list&quot;, method = RequestMethod.GET)</div><div>    private String list(Model model) {</div><div>        List&lt;Book&gt; list = bookService.getList();</div><div>        model.addAttribute(&quot;list&quot;, list);</div><div>        // list.jsp + model = ModelAndView</div><div>        return &quot;list&quot;;// WEB-INF/jsp/&quot;list&quot;.jsp</div><div>    }</div><div><br/></div><div>    // ajax json</div><div>    @RequestMapping(value = &quot;/{bookId}/detail&quot;, method = RequestMethod.GET)</div><div>    @ResponseBody</div><div>    private String detail(@PathVariable(&quot;bookId&quot;) Long bookId, Model model) {</div><div>        if (bookId == null) {</div><div>            return &quot;redirect:/book/list&quot;;</div><div>        }</div><div>        Book book = bookService.getById(bookId);</div><div>        if (book == null) {</div><div>            return &quot;forward:/book/list&quot;;</div><div>        }</div><div>        model.addAttribute(&quot;book&quot;, book);</div><div>        return &quot;detail&quot;;</div><div>    }</div><div><br/></div><div>    @RequestMapping(value = &quot;/{bookId}/appoint&quot;, method = RequestMethod.POST, produces = {</div><div>            &quot;application/json; charset=utf-8&quot; })</div><div>    private Result&lt;AppointExecution&gt; appoint(@PathVariable(&quot;bookId&quot;) Long bookId, @Param(&quot;studentId&quot;) Long studentId) {</div><div>        if (studentId == null || studentId.equals(&quot;&quot;)) {</div><div>            return new Result&lt;&gt;(false, &quot;学号不能为空&quot;);</div><div>        }</div><div>        AppointExecution execution = bookService.appoint(bookId, studentId);</div><div>        return new Result&lt;AppointExecution&gt;(true, execution);</div><div>    }</div><div><br/></div><div>}</div><div><br/></div></div><div>前端就不在写了，整个的目录结构如下</div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><img src="步骤_files/Image [3].png" type="image/png" style="height: auto;"/></div></div><div><br/></div><div><span style="font-size: 19px;"><br/></span></div><div><br/></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;"><br/></span></div><div><span style="font-size: 19px;"><br/></span></div></span>
</div></body></html> 